{% extends "layout.html" %}
{% block page_title %}Add attachment{% endblock %}

{% block content %}

{% if data['attachment-count'] %}
  {% set attachment_count = (data['attachment-count'] | int) + 1 %}
{% else %}
  {% set attachment_count = 1 %}
{% endif %}

{% if attachmentId %}
  {% set editing = true %}
  {% set attachment_id = attachmentId %}
{% else %}
  {% set attachment_id = attachment_count %}
{% endif %}

<a href="/document-tasks" class="govuk-c-back-link">Back</a>
<main role="main" class="govuk-o-main-wrapper">
  <form action="/document-tasks" method="post" class="form" data-module="fake-filename-from-title">
    <div class="govuk-o-grid">
      <div class="govuk-o-grid__item govuk-o-grid__item--two-thirds">
        <h1 class="form-title govuk-heading-xl">
          <span class="govuk-caption-xl">{{ data['title'] }}</span>
          Add attachment
        </h1>
      </div>
    </div>

    <div class="govuk-o-grid" data-module="live-content-check">
      <div class="govuk-o-grid__item govuk-o-grid__item--two-thirds">
        <div class="govuk-!-mb-r6 is-input">
          <label class="govuk-c-label" for="attachment-title">
            Attachment title
          </label>
          <input required type="text" name="{{ attachment_id }}-attachment-title" class="js-check-content govuk-c-input" id="attachment-title" data-target="attachment-title-checks" value="{% if editing %}{{data[attachment_id + '-attachment-title']}}{% endif %}">
          <span class="govuk-c-label__hint govuk-body" style="margin-top: -25px">65 characters or fewer</span>

          <input type="hidden" name="{{ attachment_id }}-attachment-filename" class="js-dynamic-filename" value="{% if editing %}{{data[attachment_id + '-attachment-filename']}}{% endif %}">

          {% if editing %}
          {% else %}
            <input type="hidden" name="attachment-count" value="{{ attachment_count }}">
          {% endif %}
        </div>
      </div>
    </div>

    <div class="govuk-o-grid">
      <div class="govuk-o-grid__item govuk-o-grid__item--two-thirds">
        <div class="govuk-!-mb-r6 is-input">
          <label class="govuk-c-label" for="attachment-file">
            File
          </label>
          <input type="file" name="attachment-file" class="govuk-c-file-upload">
        </div>
      </div>
    </div>

    <div class="govuk-!-mb-r6">
      <input type="submit" class="govuk-c-button" value="Save">
    </div>
    {% if editing %}
    <div class="govuk-!-mb-r6">
      <a href="/document-tasks" class="button button-link">Discard changes</a>
    </div>
    {% endif %}
  </form>
</main>
{% endblock %}
